<Window x:Class="Proc.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:tb="http://www.hardcodet.net/taskbar"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="{DynamicResource ThemeBgTransparent}"
        Topmost="True"
        ShowInTaskbar="False"
        SizeToContent="WidthAndHeight"
        ResizeMode="NoResize"
        MouseLeftButtonDown="Window_MouseLeftButtonDown"
        MouseDoubleClick="Window_MouseDoubleClick">
    <Window.ContextMenu>
        <ContextMenu>
            <MenuItem x:Name="ToggleTitleMenu" Header="Show Title" IsCheckable="True" IsChecked="True"
                      Click="ToggleTitle_Click"/>
            <Separator/>
            <MenuItem Header="Analysis" Click="Analysis_Click"/>
            <MenuItem Header="Settings" Click="Settings_Click"/>
            <Separator/>
            <MenuItem Header="Import CSV..." Click="Import_Click"/>
            <Separator/>
            <MenuItem Header="Exit" Click="Exit_Click"/>
        </ContextMenu>
    </Window.ContextMenu>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <tb:TaskbarIcon x:Name="TrayIcon" ToolTipText="Proc" IconSource="/Proc.ico"
                        TrayLeftMouseDown="TrayIcon_LeftClick">
            <tb:TaskbarIcon.ContextMenu>
                <ContextMenu>
                    <MenuItem Header="Show/Hide" Click="ToggleVisibility_Click"/>
                    <Separator/>
                    <MenuItem Header="Analysis" Click="Analysis_Click"/>
                    <MenuItem Header="Settings" Click="Settings_Click"/>
                    <Separator/>
                    <MenuItem Header="Import CSV..." Click="Import_Click"/>
                    <Separator/>
                    <MenuItem Header="Exit" Click="Exit_Click"/>
                </ContextMenu>
            </tb:TaskbarIcon.ContextMenu>
        </tb:TaskbarIcon>
        <TextBlock x:Name="TotalTimeText"
                   Grid.Row="0"
                   Text="Total: 0m"
                   Foreground="{DynamicResource ThemeSubText}"
                   FontFamily="Consolas"
                   FontSize="11"
                   Margin="6,4,6,1"/>
        <ItemsControl x:Name="ActivityList" Grid.Row="1" Padding="4,0,4,2">
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal" x:Name="RowPanel">
                        <TextBlock Text="{Binding TimeDisplay}" x:Name="MinutesText"
                                   Foreground="{DynamicResource ThemeText}"
                                   FontFamily="Consolas" FontSize="12" TextAlignment="Right" Margin="0,0,4,0"/>
                        <Image Source="{Binding Icon}" Width="14" Height="14" Margin="0,1,4,0"
                               VerticalAlignment="Center" RenderOptions.BitmapScalingMode="HighQuality"/>
                        <TextBlock Text="{Binding Process}" x:Name="ProcessText"
                                   Foreground="{DynamicResource ThemeSubText}"
                                   FontFamily="Consolas" FontSize="12"/>
                        <TextBlock Text="{Binding Title}" x:Name="TitleText"
                                   Foreground="{DynamicResource ThemeText}"
                                   FontFamily="Consolas" FontSize="12" Margin="6,0,0,0"
                                   Visibility="{Binding TitleVisibility}"/>
                    </StackPanel>
                    <DataTemplate.Triggers>
                        <DataTrigger Binding="{Binding IsActive}" Value="True">
                            <Setter TargetName="MinutesText" Property="Foreground" Value="{DynamicResource ThemeActiveTime}"/>
                            <Setter TargetName="ProcessText" Property="Foreground" Value="{DynamicResource ThemeActiveAccent}"/>
                            <Setter TargetName="TitleText" Property="Foreground" Value="{DynamicResource ThemeActiveAccent}"/>
                        </DataTrigger>
                    </DataTemplate.Triggers>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
    </Grid>
</Window>
